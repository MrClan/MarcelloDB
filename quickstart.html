<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>MarcelloDB</title>

        <link rel="stylesheet" href="http://markmeeus.github.io/MarcelloDB/css/bootstrap.min.css">
        <link rel="stylesheet" href="http://markmeeus.github.io/MarcelloDB/css/font-awesome.min.css">
        <link rel="stylesheet" href="http://markmeeus.github.io/MarcelloDB/css/highlight.tomorrow-night.css">
        <link rel="stylesheet" href="http://markmeeus.github.io/MarcelloDB/css/main.css">
    </head>
    <body>

        <header class="navbar navbar-default navbar-fixed-top" style='background:#FFF;height:60px;'>

            <a class="navbar-brand" href="http://markmeeus.github.io/MarcelloDB/" style="position:relative;top:-40px;">
                <img style="width:240px;" src="http://markmeeus.github.io/MarcelloDB/images/logo/logo_blue.svg">
                <small class="hidden-xs hidden-sm" style="position:relative;top:4px; color:#000; font-size:30px;">
                    NoSQL Data Storage for Xamarin and Windows Apps
                </small>
            </a>

                            <a href="https://github.com/markmeeus/marcellodb">
                    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
                </a>
            
        </header>

        <main class="container-fluid">
            <div class="row">

                
                    <nav id="sidebar" class="col-sm-3 col-lg-2" role="navigation">

                                                    <p class="text-muted">
                                Main documentation
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/">
                                            Home
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/quickstart.html">
                                            Quickstart Guide
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/sessions.html">
                                            Sessions, CollectionFiles and Collections
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/persisting.html">
                                            Persist and Destroy
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/reading.html">
                                            Find and Enumerate
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/indexes.html">
                                            Indexes
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/transactions.html">
                                            Transactions
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/encryption.html">
                                            Encryption
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/upgrade04.html">
                                            Upgrading to 0.4
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/upgrade05.html">
                                            Upgrading to 0.5
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/roadmap.html">
                                            Roadmap to 1.0
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/longterm.html">
                                            After 1.0
                                        </a>
                                    </li>
                                                            </ul>
                        
                    </nav>

                
                <section class="col-sm-offset-3 col-lg-offset-2 col-sm-9 col-lg-10">
                    <h2 id="quickstart-guide">Quickstart Guide</h2>
<h3 id="install--marcellodb-using-nuget">Install  MarcelloDB using nuget.</h3>
<p>MarcelloDB is released on nuget.org, so it is pretty easy to install.</p>
<pre><code class="language-cs">PM &gt; Install-Package MarcelloDB</code></pre>
<h3 id="create-a-platform-object">Create a platform object.</h3>
<p>The thing with writing mobile apps in c# is that the common api between the targetted platforms is a subset of the .net api.
Access to the filesystem for instance is not available cross-platform.
So we need to 'inject' the platform specific features into MarcelloDB.</p>
<p>These features are available in so-called <code>Platform</code> objects.
We can find a platform object for regular .net, which works for Xamarin (iOS and Android) in MarcelloDB.netfx.dll. The implementation for Windows(8.1 and 10) apps in MarcelloDB.uwp.dll.</p>
<p>Our nuget client should automatically add the references to these platform specific assemblies in our projects.</p>
<p>So, create a platform like this:</p>
<pre><code class="language-cs">  //On Android, iOS and regular .net or mono:
  var platform =  new MarcelloDB.netfx.Platform();

  //In a windows (or phone) 8.1/10
  var platform =  new MarcelloDB.uwp.Platform();
</code></pre>
<h3 id="open-a-session">Open a session</h3>
<p>Before we can start accessing data, we should create a <code>Session</code> object.</p>
<p>Opening a session requires the platform instance (see previous step) and a directory path. MarcelloDB will store all data in this directory.</p>
<p>This code is platform independent so we can implement this in shared code.</p>
<pre><code class="language-cs">//                              Injecting the platform here
//                                      ||
var session = new MarcelloDB.Session(platform, dataPath);</code></pre>
<p>Sessions are designed to be long-lived. We can open the session when our app starts, and keep it open until it closes.</p>
<p>A static or singleton is perfectly fine, it also makes sense to register it in an IOC container.</p>
<h3 id="access-a-collection">Access a collection</h3>
<p>A <code>Collection</code> is the MarcelloDB equivalent of a table. Collections are kept together in a <code>CollectionFile</code>.</p>
<p>In other words, a <code>CollectionFile</code> is a file containing one or more collections.</p>
<p>These files are stored in the sessions directory.</p>
<p>We can get a collection-file from the session like this:</p>
<pre><code class="language-cs">//                        File in the data directory
//                              ||
var personsFile = session["persons.dat"];</code></pre>
<p>Then, we can get a collection from the collection-file.</p>
<p>It needs a name, and an Object-To-ID mapping function which should return the unique ID for the given object.</p>
<pre><code class="language-cs">//                        Store instances of  [Person][ID is a string] [map Person to ID]
//                                               ||      ||   Collection name   ||
//                                               ||      ||        ||           ||
var personsCollection = personsFile.Collection&lt;Person, string&gt;("persons", p =&gt; p.Id);
</code></pre>
<p>The two generic arguments are there so that the compiler will protect us from mistakes. The first one (Person) is the type of objects you can store in the collection. The second one (string) is the type of the ID. The Object-To-ID mapper takes a Person and should return a string.</p>
<blockquote>
<p>This collection will happily store subclasses of Person too.</p>
<p>Also, the entire object is stored, including child objects, lists and dictionaries.</p>
<p>Objects are serialized to Bson (Binary json) with json.net. If json.net can serialize it, MarcelloDB can store it.</p>
</blockquote>
<h3 id="saving-an-object">Saving an object</h3>
<p>Let's create some object</p>
<pre><code class="language-cs">var person = new Person{
  id = "1",
  Name = "Snow",
  FirstName = "Jon",
  Addresses = new List&lt;Address&gt;{
    new Address{ City = "Castle Black" },
    new Address{ City = "Winterfell" }
  }
}</code></pre>
<p>And save it in the collection</p>
<pre><code class="language-cs">personsCollection.Persist(person);</code></pre>
<h3 id="finding-data">Finding data</h3>
<p>The simplest way to find data is by it's ID. The find method does just that.</p>
<pre><code class="language-cs">var jon = personsCollection.Find("1");</code></pre>
<blockquote>
<p>Remember the Collection<em>&lt;Person, string&gt;</em> ?</p>
<p>Find now takes a <em>string</em> and returns a <em>Person</em>.</p>
</blockquote>
<p>There are plenty more options to search and enumerate our objects if we define <a href="indexes.html">indexes</a> on our collection, .</p>
<h3 id="deleting-data">Deleting data</h3>
<p>If we are really sure Jon won't come back...</p>
<pre><code class="language-cs">personsCollection.Delete("1");</code></pre>
                </section>

            </div>
        </main>

        <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script src="//yandex.st/highlightjs/7.5/highlight.min.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');
                // Syntax highlighting
                hljs.initHighlightingOnLoad();
            });
        </script>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-539759-16', 'auto');
          ga('send', 'pageview');

        </script>
    </body>
</html>
