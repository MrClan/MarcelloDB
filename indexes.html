<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>MarcelloDB</title>

        <link rel="stylesheet" href="http://markmeeus.github.io/MarcelloDB/css/bootstrap.min.css">
        <link rel="stylesheet" href="http://markmeeus.github.io/MarcelloDB/css/font-awesome.min.css">
        <link rel="stylesheet" href="http://markmeeus.github.io/MarcelloDB/css/highlight.tomorrow-night.css">
        <link rel="stylesheet" href="http://markmeeus.github.io/MarcelloDB/css/main.css">
    </head>
    <body>

        <header class="navbar navbar-default navbar-fixed-top" style='background:#FFF;height:60px;'>

            <a class="navbar-brand" href="http://markmeeus.github.io/MarcelloDB/" style="position:relative;top:-40px;">
                <img style="width:240px;" src="http://markmeeus.github.io/MarcelloDB/images/logo/logo_blue.svg">
                <small class="hidden-xs hidden-sm" style="position:relative;top:4px; color:#000; font-size:30px;">
                    NoSQL Data Storage for Xamarin and Windows Apps
                </small>
            </a>

                            <a href="https://github.com/markmeeus/marcellodb">
                    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
                </a>
            
        </header>

        <main class="container-fluid">
            <div class="row">

                
                    <nav id="sidebar" class="col-sm-3 col-lg-2" role="navigation">

                                                    <p class="text-muted">
                                Main documentation
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/">
                                            Home
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/quickstart.html">
                                            Quickstart Guide
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/sessions.html">
                                            Sessions, CollectionFiles and Collections
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/persisting.html">
                                            Persist and Destroy
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/reading.html">
                                            Find and Enumerate
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/indexes.html">
                                            Indexes
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/transactions.html">
                                            Transactions
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/encryption.html">
                                            Encryption
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/upgrade04.html">
                                            Upgrading to 0.4
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/upgrade05.html">
                                            Upgrading to 0.5
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/roadmap.html">
                                            Roadmap to 1.0
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://markmeeus.github.io/MarcelloDB/longterm.html">
                                            After 1.0
                                        </a>
                                    </li>
                                                            </ul>
                        
                    </nav>

                
                <section class="col-sm-offset-3 col-lg-offset-2 col-sm-9 col-lg-10">
                    <h1 id="indexes">Indexes</h1>
<p>Enumerating all objects in a collection to find a specific instance is not always be the best approach.
If the collection contains thousands of objects, they will all be read from disk and deserialized,  performance will degrade fast.</p>
<p>For such scenarios it's probably a good idea to add indexes to your collection.
MarcelloDB Indexes are implemented with a BTree algorithm, which makes them really efficient.</p>
<p>Besides searching for objects, indexes can also be used to iterate over the collection (or a subset) ordered by the indexed value.</p>
<p>There is no hard limit on the amount of indexes on a collection. However, too much indexes will slow down calls to Persist, and will increase the total filesize of the collection-file.</p>
<h2 id="indexdefinition">IndexDefinition</h2>
<p>Indexes are enabled on collections created with an IndexDefinition as third generic argument.</p>
<p>Like this:</p>
<pre><code class="language-cs">productsFile.Collection&lt;Book, string, BookIndexDefiniton&gt;("books", book =&gt; book.Id);</code></pre>
<p>The index definition should derive from <code>MarcelloDB.Index.IndexDefinition&lt;T&gt;</code></p>
<p><code>T</code> should equal the type of the objects in the collection.</p>
<p>For instance:</p>
<pre><code class="language-cs">//Define indexes
class BookIndexDefinition : IndexDefinition&lt;Book&gt;
{                                            //
  /*...*/                                    //
}                                            //
//                                           //
//Create collection      //-------&gt;Book-----&gt;//
productsFile.Collection&lt;Book, string, BookIndexDefiniton&gt;("books", book =&gt; book.Id);
//                            ------------------</code></pre>
<h3 id="index-properties">Index Properties</h3>
<p>Indexes are defined by declaring properties on the index definition.</p>
<p>These properties can be of type IndexedValue<> or IndexedList<></p>
<pre><code class="language-cs">///
/// This IndexDefinition can be used to index
//                             instances of Book
///                                          ||
class BookIndexDefinition : IndexDefinition&lt;Book&gt;
{
   //           Create an index named Title
   //                                  ||
   public  IndexedValue&lt;Book, string&gt; Title { /*...*/ }
   //                    ||     ||
   //  (for instances of Book)
   //                     as a string
   //

   //                Create an index named CategoryId_Code
   //                                             ||
   public  IndexedValue&lt;Book, int, string&gt; CategoryId_Code { /*...*/ }
   //                    ||   ||      ||
   // (for instances of Book) ||      ||
   //                         ||      ||
   // As a combination of an integer  ||
   //                          and a string

   //          Create an index named Tags
   //  indexing a list                ||
   //              ||                 ||
   public  IndexedList&lt;Book, string&gt; Tags { /*...*/ }
   //                   ||     ||
   //(for instances of Book)   ||
   //             values are string
   //
}</code></pre>
<h2 id="indexing-a-single-value-or-a-list-of-values">Indexing a Single Value or a List of Values</h2>
<p>An index is a bit like a sorted list, it keeps references to the objects sorted by the indexed value.
MarcelloDB is able to keep 1 or more references to an object in the same index.</p>
<p>Take for example this class:</p>
<pre><code>class Article
{
  public string       Title       { get; set; }
  public int          CategoryID  { get; set; }
  public List&lt;string&gt; Tags        { get; set; }
}</code></pre>
<p>An index on <code>Category</code> will result in a single index entry per object.
An index on <code>`Tags</code> on the other hand can contain more than 1 entry per object.</p>
<p>More in detail:</p>
<ul>
<li><a href="indexing/indexed_value.html">Indexing one or more fields with <code>IndexedValue</code> </a></li>
<li><a href="indexing/indexed_list.html">Indexing a list of fields with <code>IndexedList</code></a></li>
</ul>
<h2 id="using-indexes">Using indexes</h2>
<p>A collection created with an index definition has a property named <code>`Indexes</code>.
This property returns an instance of the IndexDefinition used to construct the collection.
Every index on that definition can now be used to iterate, and search the data sorted by the indexed value.</p>
<p>All enumerations are implemented in a lazy fashion. The next object is only loaded when actually requested by the iteration.
So don't worry if you have a really large amount of data, MarcelloDB only loads the current object.</p>
<h3 id="all-indexedvalue">All (IndexedValue)</h3>
<p>All returns an IEnumerable<T> of all objects sorted by the indexed value.</p>
<pre><code class="language-cs">bookCollection.Indexes.Title.All; //sorted by Title</code></pre>
<h3 id="find-indexedvalue">Find (IndexedValue)</h3>
<p>Find returns an IEnumerable<T> of all objects that have the specific value for the indexed value.</p>
<pre><code class="language-cs">//All books with the title "MarcelloDB For Dummies"
boolCollection.Indexes.Title.Find("MarcelloDB For Dummies")</code></pre>
<p>(In later versions, you'll be able to define a unique index, in which case a find will return just a single object, no IEnumerable.)</p>
<h3 id="between-and-indexedvalue">Between And (IndexedValue)</h3>
<p>You can iterate objects with an indexed value wich is contained in a range.</p>
<pre><code class="language-cs">//all books suitable for 8 and 13, edges not included
bookCollection.Indexes.AgeRecommendation.Between(8).And(13)</code></pre>
<pre><code class="language-cs">//all books suitable for 8 and 13, edges included
bookCollection.Indexes.AgeRecommendation.BetweenIncluding(8).AndIncluding(13)</code></pre>
<h3 id="greaterthan-orequal-indexedvalue">GreaterThan (OrEqual) (IndexedValue)</h3>
<p>Starts iteration at a specific value till the end of the index.</p>
<pre><code class="language-cs">//all books suitable +12
bookCollection.Indexes.AgeRecommendation.GreaterThan(12)</code></pre>
<pre><code class="language-cs">//all books suitable 12 and up
bookCollection.Indexes.AgeRecommendation.GreaterThanOrEqual(12)</code></pre>
<h3 id="smallerthan-orequal-indexedvalue">SmallerThan (OrEqual) (IndexedValue)</h3>
<p>Starts iteration at the beginning of the indexe untill a specific value</p>
<pre><code class="language-cs">//all books suitable for -12
bookCollection.Indexes.AgeRecommendation.SmallerThan(12)</code></pre>
<pre><code class="language-cs">//all books suitable up until 12
bookCollection.Indexes.AgeRecommendation.SmallerThanOrEqual(12)</code></pre>
<h3 id="descending-indexedvalue">Descending (IndexedValue)</h3>
<p>Every index scope can be reversed to iterate your objects in a descending order</p>
<pre><code class="language-cs">//starting from 12 down to 0
bookCollection.Indexes.AgeRecommendation.SmallerThan(12).Descending
//starting from the max value down to 12
bookCollection.Indexes.AgeRecommendation.GreaterThan(12).Descending
//from 16 down to 12
bookCollection.Indexes.AgeRecommendation.Between(12).And(16).Descending</code></pre>
<h3 id="iterating-the-keys-of-an-index-indexedvalue">Iterating the keys of an index (IndexedValue)</h3>
<p>You can iterate all keys of an index:</p>
<pre><code class="language-cs">bookCollection.Indexes.AgeRecommendation.SmallerThan(12).Keys
//works also on the Descending scope
bookCollection.Indexes.AgeRecommendation.SmallerThan(12).Descending.Keys</code></pre>
<h3 id="contains-indexedlist">Contains (IndexedList)</h3>
<p>Enumerates objects that have a specific item in the list.</p>
<pre><code class="language-cs">bookCollections.Indexes.Tags.Contains("Thriller");</code></pre>
<h3 id="containsany-indexedlist">ContainsAny (IndexedList)</h3>
<p>Enumerates objects that have at least one of the items in the list</p>
<pre><code class="language-cs">bookCollections.Indexes.Tags.ContainsAny(new string[] {"Thriller", "Comedy"});</code></pre>
<h3 id="containsall-indexedlist">ContainsAll (IndexedList)</h3>
<p>Enumerates objects that have all of the items in the list</p>
<pre><code class="language-cs">bookCollections.Indexes.Tags.ContainsAny(new string[] {"Thriller", "Comedy"});</code></pre>
                </section>

            </div>
        </main>

        <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script src="//yandex.st/highlightjs/7.5/highlight.min.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');
                // Syntax highlighting
                hljs.initHighlightingOnLoad();
            });
        </script>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-539759-16', 'auto');
          ga('send', 'pageview');

        </script>
    </body>
</html>
